import React, { useState } from "react";
import { useRouter } from "next/router";
import axios from "axios";
import { backendURL } from "@/config/config";

import { useSelector } from "react-redux";
import BadgeIcon from "@mui/icons-material/Badge";
import FactCheckIcon from "@mui/icons-material/FactCheck";
import Info from "@/components/patients/Info";
import ClinicHistory from "@/components/patients/ClinicHistory";
import Odontogram from "@/components/patients/Odontogram";
import Consent from "@/components/patients/Consent";

import { FaUserEdit } from "react-icons/fa";
import Image from "next/image";

const Paciente = () => {
  const [selectedTab, setSelectedTab] = useState("0");

  const tabs = [
    {
      icon: (
        <svg
          xmlns="http://www.w3.org/2000/svg"
          className="w-5 h-5 mr-2 "
          fill="none"
          viewBox="0 0 24 24"
          strokeWidth="1.5"
          stroke="currentColor"
        >
          <path
            strokeLinecap="round"
            strokeLinejoin="round"
            d="M15 9h3.75M15 12h3.75M15 15h3.75M4.5 19.5h15a2.25 2.25 0 002.25-2.25V6.75A2.25 2.25 0 0019.5 4.5h-15a2.25 2.25 0 00-2.25 2.25v10.5A2.25 2.25 0 004.5 19.5zm6-10.125a1.875 1.875 0 11-3.75 0 1.875 1.875 0 013.75 0zm1.294 6.336a6.721 6.721 0 01-3.17.789 6.721 6.721 0 01-3.168-.789 3.376 3.376 0 016.338 0z"
          ></path>
        </svg>
      ),
      name: "Info",
      id: "0",
    },
    {
      icon: (
        <svg
          aria-hidden="true"
          className="w-5 h-5 mr-2 "
          fill="currentColor"
          viewBox="0 0 20 20"
          xmlns="http://www.w3.org/2000/svg"
        >
          <path d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"></path>
          <path
            fillRule="evenodd"
            d="M4 5a2 2 0 012-2 3 3 0 003 3h2a3 3 0 003-3 2 2 0 012 2v11a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 4a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h3a1 1 0 100-2h-3zm-3 4a1 1 0 100 2h.01a1 1 0 100-2H7zm3 0a1 1 0 100 2h3a1 1 0 100-2h-3z"
            clipRule="evenodd"
          ></path>
        </svg>
      ),
      name: "Historia Clinica",
      id: "1",
    },
    {
      icon: (
        <svg
          className="w-5 h-5 mr-2 "
          xmlns="http://www.w3.org/2000/svg"
          xmlnsXlink="http://www.w3.org/1999/xlink"
          fill="currentColor"
          version="1.1"
          id="Layer_1"
          viewBox="0 0 64 64"
          enableBackground="new 0 0 64 64"
          xmlSpace="preserve"
        >
          <path
            id="Tooth_2_"
            d="M54.3148651,5.0702143c-3.5253983-3.6377001-8.4227982-5.4512-13.472599-4.9921999  c-0.0372009,0.001-0.0762024,0.0019-0.1133003,0.0049c-1.6397018,0.1611-3.1631012,0.8252-4.6366997,1.4687001  c-1.5165901,0.6621001-2.9492989,1.2871001-4.3290997,1.2871001c-1.3838005,0-2.8124886-0.6259-4.325201-1.289  c-1.4619999-0.6407-2.9736996-1.3028001-4.6035995-1.4668001c-4.9531002-0.501-9.7802,1.2636-13.2469997,4.8301001  c-3.4667997,3.5663996-5.0899,8.4393997-4.4550996,13.3592997c2.6244998,22.700201,4.4779992,36.6513977,5.5082994,41.4648972  c0.3237,1.5166016,1.9116001,3.8935013,3.9375,4.2256012c0.1352005,0.0223999,0.2915001,0.038002,0.4643002,0.038002  c0.8149996,0,1.9883118-0.3476028,2.9648991-1.9960022c1.4033012-2.3702011,2.6221008-5.642601,3.9131012-9.1083984  c2.6425991-7.0937996,5.6385994-15.1348,10.4218998-15.2110023c4.7490005,0.0956993,7.1541977,6.8535004,9.481411,13.3887024  c1.241188,3.4891968,2.4150009,6.785099,3.9677887,9.2782974c1.0332108,1.6611023,2.6805992,2.4815025,4.4179001,2.1826019  c1.5683975-0.2656021,2.8788986-1.4121017,3.1875-2.7881012c1.3194008-5.8711014,3.6992989-25.5126991,5.4638977-40.9589005  C59.5199661,13.7323141,57.863678,8.7323141,54.3148651,5.0702143z M56.8773651,18.537014  c-0.0009995,0.0058002-0.0018997,0.0107002-0.0018997,0.0165997c-1.7597885,15.3984013-4.1299019,34.9697037-5.4296989,40.7557983  c-0.1319008,0.5849991-0.8067017,1.125-1.5703011,1.2538986c-0.5381012,0.0938034-1.5665016,0.0479012-2.3867874-1.267498  c-1.4384117-2.3106003-2.5761108-5.5078011-3.7812119-8.8916016c-2.5546989-7.1758003-5.1953011-14.594799-11.3604012-14.7187996  c-6.1854992,0.0986023-9.4344997,8.8194008-12.3006992,16.5126991c-1.2588005,3.3799019-2.4482994,6.5713005-3.7598,8.7871017  c-0.6640997,1.1231003-1.2060995,1.0321999-1.3852997,1.0038986c-0.9515886-0.1562004-2.0815001-1.6229973-2.3046999-2.669899  c-1.0028887-4.6855011-2.8973999-18.9589996-5.4794002-41.2900009c-0.5576997-4.3233004,0.8652-8.5957003,3.9043002-11.7217007  c2.7005997-2.7793,6.3442106-4.3066998,10.1683989-4.3066998c0.4794998,0,0.9619007,0.0235,1.4453011,0.0723002  c1.3155117,0.1317999,2.6191998,0.7031,4,1.3085999c0.6203995,0.2716999,1.2488995,0.5463998,1.8883991,0.7834997  c0.0491123,0.0377002,0.0876999,0.0852003,0.1448002,0.1140003l9.9726982,5.0399995  c0.1445007,0.0732002,0.2988014,0.1073999,0.4502029,0.1073999c0.3652,0,0.7176971-0.2001991,0.8934975-0.5487995  c0.2490997-0.4932003,0.0517998-1.0946999-0.4413986-1.3438001l-5.8496017-2.9555998  c1.0969124-0.2781,2.1592026-0.7402,3.1992035-1.1938002c1.375-0.6006,2.6738968-1.1670001,3.88871-1.3016999  c0.04879,0.0028999,0.0966873,0.0009999,0.1454887-0.0039001c4.4755974-0.4395,8.827198,1.1601,11.952198,4.3838  C56.0013657,9.6854143,57.4593658,14.0868139,56.8773651,18.537014z"
          ></path>
        </svg>
      ),
      name: "Odontograma",
      id: "3",
    },
    {
      icon: (
        <svg
          className="w-5 h-5 mr-2 "
          xmlns="http://www.w3.org/2000/svg"
          xmlnsXlink="http://www.w3.org/1999/xlink"
          fill="currentColor"
          version="1.1"
          id="Layer_1"
          viewBox="0 0 512.003 512.003"
          xmlSpace="preserve"
        >
          <g>
            <g>
              <path d="M102.403,0.002c-42.351,0-76.8,34.449-76.8,76.8c0,42.351,34.449,76.8,76.8,76.8c42.351,0,76.8-34.449,76.8-76.8    C179.203,34.451,144.754,0.002,102.403,0.002z M102.403,128.002c-28.279,0-51.2-22.921-51.2-51.2s22.921-51.2,51.2-51.2    s51.2,22.921,51.2,51.2S130.683,128.002,102.403,128.002z"></path>
            </g>
          </g>
          <g>
            <g>
              <path d="M384.003,0.002c-42.351,0-76.8,34.449-76.8,76.8c0,42.351,34.449,76.8,76.8,76.8s76.8-34.449,76.8-76.8    C460.803,34.451,426.354,0.002,384.003,0.002z M384.003,128.002c-28.279,0-51.2-22.921-51.2-51.2s22.921-51.2,51.2-51.2    c28.279,0,51.2,22.921,51.2,51.2S412.283,128.002,384.003,128.002z"></path>
            </g>
          </g>
          <g>
            <g>
              <path d="M486.403,325.122h-3.302l-22.707-124.894c-2.219-12.177-12.817-21.026-25.19-21.026h-102.4    c-5.811,0-11.452,1.98-15.991,5.606L255.73,233.67l-89.429-51.106c-3.866-2.202-8.243-3.362-12.698-3.362h-102.4    c-12.373,0-22.972,8.849-25.19,21.026l-25.6,140.8c-1.357,7.467,0.666,15.155,5.53,20.983c4.872,5.82,12.066,9.19,19.661,9.19    h16.358l9.327,117.231c1.058,13.303,12.169,23.569,25.515,23.569h51.2c13.355,0,24.465-10.266,25.515-23.569l11.196-140.8    l6.485-63.394l63.778,21.606c2.688,0.913,5.461,1.357,8.226,1.357c4.437,0,8.738-1.408,12.638-3.652    c3.994,2.355,8.448,3.652,12.962,3.652c3.678,0,7.364-0.794,10.795-2.389l35.985-16.742l6.153,60.134l11.145,140.22    c1.058,13.312,12.169,23.578,25.523,23.578h51.2c13.355,0,24.465-10.266,25.523-23.569l4.233-53.231h47.044    c14.14,0,25.6-11.46,25.6-25.6v-58.88C512.003,336.582,500.543,325.122,486.403,325.122z M243.203,281.602l-94.191-31.915    l-9.813,95.915l-11.196,140.8h-51.2l-11.196-140.8H25.603l25.6-140.8h38.4v77.875c0,7.074,5.726,12.8,12.8,12.8    c7.074,0,12.8-5.726,12.8-12.8v-77.875h38.4l89.6,51.2V281.602z M409.603,486.402h-51.2l-11.196-140.8l-9.813-95.915    l-68.591,31.915v-25.6l64-51.2h38.4v77.875c0,7.074,5.726,12.8,12.8,12.8c7.074,0,12.8-5.726,12.8-12.8v-77.875h38.4    l21.879,120.32h-52.599c-14.14,0-25.6,11.46-25.6,25.6v58.88c0,14.14,11.46,25.6,25.6,25.6h9.19L409.603,486.402z     M486.403,409.602h-81.92v-58.88h81.92V409.602z"></path>
            </g>
          </g>
        </svg>
      ),
      name: "Consentimientos",
      id: "4",
    },
  ];
    const router = useRouter();
  const id = router.query.id;
  const [isLoading, setIsLoading] = useState(false);
  const patients = useSelector((state) => state.clinic.patients);

  const currentPatient = patients.find((obj) => obj._id === id);

  return (
    <>
      <div className=" border-b my-4 mx-2 border-zinc-300 dark:border-zinc-500">
        {currentPatient && (
           <div className="flex justify-center items-center gap-2">
           {" "}
           <Image
             width={100}
             height={100}
             alt="Paciente"
             className="w-6 h-6"
             src={
               currentPatient.sex === "Hombre"
                 ? "/assets/icons/patientMan.png"
                 : "/assets/icons/patientWoman.png"
             }
           />
           <span className="text-gray-600 font-bold text-sm">{currentPatient.names}</span>{" "}
         </div>

        )}
       
        <ul className="flex flex-wrap justify-center gap-3 -mb-px text-sm font-medium text-center text-zinc-700 dark:text-zinc-400 my-2">
          {tabs.map((e) => (
            <li key={e.key} className="mr-2">
              <button
                onClick={() => setSelectedTab(e.id)}
                className={`${
                  selectedTab === e.id
                    ? "text-blue-500  font-bold"
                    : "dark:text-zinc-300 text-zinc-500 "
                } inline-flex p-4 border-b-2 border-transparent rounded-t-lg  hover:text-blue-600 hover:border-blue-300 dark:hover:text-blue-500 group`}
              >
                {e.icon}
                {e.name}
              </button>
            </li>
          ))}
        </ul>
      </div>

      {currentPatient && (
        <>
          {selectedTab === tabs[0].id && <Info data={currentPatient} />}
          {selectedTab === tabs[1].id && (
            <ClinicHistory data={currentPatient} />
          )}
          {selectedTab === tabs[2].id && <Odontogram data={currentPatient} />}
          {selectedTab === tabs[3].id && <Consent data={currentPatient} />}
        </>
      )}
    </>
  );
};

export default Paciente;
